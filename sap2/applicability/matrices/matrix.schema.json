{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "sap2.applicability.matrix.schema.json",
  "title": "SAP² Applicability Matrix Schema",
  "type": "object",
  "additionalProperties": false,
  "required": ["schema_version", "family", "methods"],
  "properties": {
    "schema_version": {
      "type": "string",
      "pattern": "^[0-9]+\\.[0-9]+$"
    },
    "family": {
      "type": "string",
      "minLength": 1
    },
    "methods": {
      "type": "object",
      "minProperties": 1,
      "additionalProperties": { "$ref": "#/$defs/methodSpec" }
    }
  },
  "$defs": {
    "requirementLevel": {
      "type": "string",
      "enum": ["required", "optional", "not_applicable"]
    },
    "requiresSpec": {
      "type": "object",
      "additionalProperties": false,
      "required": ["E", "Δ", "S", "V", "M", "R"],
      "properties": {
        "E": { "$ref": "#/$defs/requirementLevel" },
        "Δ": { "$ref": "#/$defs/requirementLevel" },
        "S": { "$ref": "#/$defs/requirementLevel" },
        "V": { "$ref": "#/$defs/requirementLevel" },
        "M": { "$ref": "#/$defs/requirementLevel" },
        "R": { "$ref": "#/$defs/requirementLevel" }
      }
    },
    "methodSpec": {
      "type": "object",
      "additionalProperties": false,
      "required": ["label", "requires"],
      "properties": {
        "label": {
          "type": "string",
          "minLength": 1
        },
        "requires": { "$ref": "#/$defs/requiresSpec" }
      }
    }
  }
}
